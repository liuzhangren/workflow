(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0a862c50"],{"32a6":function(e,t,i){var o=i("241e"),n=i("c3a1");i("ce7e")("keys",(function(){return function(e){return n(o(e))}}))},"8aae":function(e,t,i){i("32a6"),e.exports=i("584a").Object.keys},a4bb:function(e,t,i){e.exports=i("8aae")},b3e8:function(e,t,i){"use strict";i.r(t);var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",[i("div",{staticClass:"fd-nav"},[e._m(0),i("div",{staticClass:"fd-nav-center"},[i("div",{class:"fd-nav-center-item "+(e.actives[1]?"fd-nav-center-item-active":""),on:{click:function(t){return e.selectItem(1)}}},[e._m(1),i("div",{staticStyle:{fontSize:"18px","margin-left":"4px"}},[e._v("基础设置")])]),i("div",{class:"fd-nav-center-item "+(e.actives[2]?"fd-nav-center-item-active":""),on:{click:function(t){return e.selectItem(2)}}},[e._m(2),i("div",{staticStyle:{fontSize:"18px","margin-left":"4px"}},[e._v("流程设计")])])]),i("div",{staticClass:"fd-nav-right"},[i("button",{staticClass:"ant-btn button-publish",attrs:{type:"button"},on:{click:function(t){return e.saveProcess(0)}}},[i("span",[e._v("保存")])]),i("button",{staticClass:"ant-btn button-publish",attrs:{type:"button"},on:{click:function(t){return e.saveProcess(1)}}},[i("span",[e._v("发布")])])])]),i("div",{staticClass:"fd-nav-content"},[e.actives["1"]?i("section",{staticClass:"dingflow-design"},[i("el-card",{staticClass:"box-card"},[i("el-form",{attrs:{model:e.editForm,"label-width":"80px"}},[i("el-form-item",{attrs:{label:"流程编号"}},[i("el-input",{model:{value:e.editForm.flowKey,callback:function(t){e.$set(e.editForm,"flowKey",t)},expression:"editForm.flowKey"}})],1),i("el-form-item",{attrs:{label:"流程名称"}},[i("el-input",{model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name",t)},expression:"editForm.name"}})],1)],1)],1)],1):e._e(),e.actives["2"]?i("section",{staticClass:"dingflow-design"},[i("div",{staticClass:"zoom"},[i("div",{class:"zoom-out"+(50==e.nowVal?" disabled":""),on:{click:function(t){return e.zoomSize(1)}}}),i("span",[e._v(e._s(e.nowVal)+"%")]),i("div",{class:"zoom-in"+(300==e.nowVal?" disabled":""),on:{click:function(t){return e.zoomSize(2)}}})]),i("div",{staticClass:"box-scale",style:"transform: scale("+e.nowVal/100+"); transform-origin: 50% 0px 0px; min-height: 600px;",attrs:{id:"box-scale"}},[i("nodeWrap",{attrs:{test:e.test,processConfig:e.processConfig,nodeConfig:e.nodeConfig,flowPermission:e.flowPermission,isTried:e.isTried,directorMaxLevel:e.directorMaxLevel,tableId:e.tableId},on:{"update:test":function(t){e.test=t},"update:processConfig":function(t){e.processConfig=t},"update:process-config":function(t){e.processConfig=t},"update:nodeConfig":function(t){e.nodeConfig=t},"update:node-config":function(t){e.nodeConfig=t},"update:flowPermission":function(t){e.flowPermission=t},"update:flow-permission":function(t){e.flowPermission=t},"update:isTried":function(t){e.isTried=t},"update:is-tried":function(t){e.isTried=t}}}),e._m(3)],1)]):e._e()]),i("el-dialog",{attrs:{title:"提示",visible:e.tipVisible},on:{"update:visible":function(t){e.tipVisible=t}}},[i("div",{staticClass:"ant-confirm-body"},[i("i",{staticClass:"anticon anticon-close-circle",staticStyle:{color:"#f00"}}),i("span",{staticClass:"ant-confirm-title"},[e._v("当前无法发布")]),i("div",{staticClass:"ant-confirm-content"},[i("div",[i("p",{staticClass:"error-modal-desc"},[e._v("以下内容不完善，需进行修改")]),i("div",{staticClass:"error-modal-list"},e._l(e.tipList,(function(t,o){return i("div",{key:o,staticClass:"error-modal-item"},[i("div",{staticClass:"error-modal-item-label"},[e._v("流程设计")]),i("div",{staticClass:"error-modal-item-content"},[e._v(e._s(t.name)+" 未选择"+e._s(t.type))])])})),0)])])]),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.tipVisible=!1}}},[e._v("我知道了")]),i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.tipVisible=!1}}},[e._v("前往修改")])],1)])],1)])},n=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"fd-nav-left"},[i("div",{staticClass:"fd-nav-title"},[e._v("自定义工作流")])])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"fd-nav-center-circle-box"},[i("span",{staticClass:"fd-nav-center-circle"},[e._v("1")])])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"fd-nav-center-circle-box"},[i("span",{staticClass:"fd-nav-center-circle"},[e._v("2")])])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"end-node"},[i("div",{staticClass:"end-node-circle"}),i("div",{staticClass:"end-node-text"},[e._v("流程结束")])])}],s=(i("8e6e"),i("7f7f"),i("ac6a"),i("456d"),i("bd86")),r=(i("a481"),i("28a5"),i("386d"),i("75fc")),c=i("e265"),a=i.n(c),d=i("a4bb"),l=i.n(d);function f(e,t){if(null==e)return{};var i,o,n={},s=l()(e);for(o=0;o<s.length;o++)i=s[o],t.indexOf(i)>=0||(n[i]=e[i]);return n}function u(e,t){if(null==e)return{};var i,o,n=f(e,t);if(a.a){var s=a()(e);for(o=0;o<s.length;o++)i=s[o],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}var p=i("ec26");function h(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function v(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?h(Object(i),!0).forEach((function(t){Object(s["a"])(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):h(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var m=function e(t){var i={},o=t.childNode;u(t,["childNode"]);if(o){var n=e(o);i=n}else i=t;return i},b=function e(t,i,o,n,s,c){var a=t.childNode,d=t.id,l=t.conditionNodes,f=u(t,["childNode","id","conditionNodes"]),h=f.nodeName,m=u(f,["nodeName"]);m.name=h;var b={},w={},y="";if(Object(p["a"])(),Object(p["a"])(),y=Object(p["a"])(),4==t.type)c=t.childNode?"sid-".concat(t.childNode.id):"sid-end",y=l.reduce((function(e,t){return[].concat(Object(r["a"])(e),[{resourceId:"sid-".concat(t.id)}])}),[]),b={resourceId:"sid-".concat(d),properties:v({},m),stencil:{id:"ExclusiveGateway"},outgoing:y,childShapes:[],bounds:{lowerRight:{x:100.3125,y:175},upperLeft:{x:60.90625,y:175}},dockers:[{x:15,y:15},{x:50,y:40}]},i.push(b);else if(3==t.type){var C=t.conditionsequenceflow;b={resourceId:"sid-".concat(d),properties:v(v({},m),{},{conditionsequenceflow:C}),stencil:{id:"SequenceFlow"},childShapes:[],outgoing:[{resourceId:t.childNode?"sid-".concat(t.childNode.id):o.childNode?"sid-".concat(o.childNode.id):"sid-end"}],target:{resourceId:t.childNode?"sid-".concat(t.childNode.id):o.childNode?"sid-".concat(o.childNode.id):"sid-end"},bounds:{lowerRight:{x:100.3125,y:175},upperLeft:{x:60.90625,y:175}},dockers:[{x:15,y:15},{x:50,y:40}]},i.push(b)}else{var x,O;1==t.examineMode?(x="Sequential",O="${nrOfCompletedInstances/nrOfInstances >= 1}"):2==t.examineMode?(x="Parallel",O="${nrOfCompletedInstances/nrOfInstances >= 1}"):3==t.examineMode&&(x="None",O=""),b={resourceId:"sid-".concat(d),properties:v(v({},m),{},{multiinstance_variable:"user".concat(n),multiinstance_collection:"user".concat(n,"List"),multiinstance_type:x,multiinstance_condition:O,usertaskassignment:{assignment:{candidateUsers:[{value:"#{user".concat(n,"}"),$$hashKey:"2MQ"}]}}}),bounds:{lowerRight:{x:100.3125,y:175},upperLeft:{x:60.90625,y:175}},stencil:{id:"UserTask"},outgoing:[{resourceId:"sid-".concat(y)}]};var N="";N=!t.childNode&&t.isBranch?c:"sid-end",w={resourceId:"sid-".concat(y),stencil:{id:"SequenceFlow"},properties:{overrideid:"",name:"",type:3,documentation:"",conditionsequenceflow:"",executionlisteners:"",defaultflow:"false"},childShapes:[],bounds:{lowerRight:{x:100.3125,y:175},upperLeft:{x:60.90625,y:175}},dockers:[{x:15,y:15},{x:50,y:40}],outgoing:[{resourceId:t.childNode?"sid-".concat(t.childNode.id):3==t.type?"sid-".concat(o.childNode.id):N}],target:{resourceId:t.childNode?"sid-".concat(t.childNode.id):3==t.type?"sid-".concat(o.childNode.id):N}},i.push(b,w)}return a&&(n++,e(a,i,t,n,s,c)),l&&(n++,g(l,i,t,n,s,c)),i},g=function(e,t,i,o,n,s){return e.length>0&&e.forEach((function(e){o++,b(e,t,i,o,n,s)})),t},w=function(e){m(e.nodeConfig);var t=b(e.nodeConfig,[],{},0,e,"").reduce((function(e,t){return"sid-start-node"==t.resourceId&&(t.stencil.id="StartNoneEvent",t.properties.usertaskassignment={}),[].concat(Object(r["a"])(e),[t])}),[]);t.push({resourceId:"sid-end",properties:{overrideid:"",name:"",documentation:"",executionlisteners:""},stencil:{id:"EndNoneEvent"},childShapes:[],outgoing:[],bounds:{lowerRight:{x:678,y:189},upperLeft:{x:650,y:161}},dockers:[]});var i={resourceId:"105001",properties:{process_id:"hqtest",name:"条件会签测试",documentation:"条件会签测试",process_author:"张志华",process_version:"",process_namespace:"http://www.activiti.org/processdef",executionlisteners:"",eventlisteners:"",signaldefinitions:"",messagedefinitions:""},stencil:{id:"BPMNDiagram"},childShapes:t,stencilset:{url:"stencilsets/bpmn2.0/bpmn2.0.json",namespace:"http://b3mn.org/stencilset/bpmn2.0#"},bounds:{lowerRight:{x:1200,y:1050},upperLeft:{x:0,y:0}},ssextensions:[]};return i};i("efd9");function y(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function C(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?y(Object(i),!0).forEach((function(t){Object(s["a"])(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):y(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var x={data:function(){return{editForm:{name:"",flowKey:"",categoryId:""},actives:{1:!0,2:!1},loading:!1,visible:!0,formLabelWidth:"120px",result:{},isTried:!1,tipList:[],tipVisible:!1,nowVal:100,processConfig:{},nodeConfig:{},workFlowDef:{},flowPermission:[],directorMaxLevel:0,dialogVisible:!0,tableId:"",test:"hello"}},created:function(){var e=this,t=location,i=t.search,o=i.replace("?","").split("&").reduce((function(e,t){var i=t.split("=")[0],o=t.split("=")[1];return C(C({},e),{},Object(s["a"])({},i,o))}),{}),n=sessionStorage.getItem("customJson");this.editForm=JSON.parse(sessionStorage.getItem("form")),"null"!=n?(this.processConfig=JSON.parse(n),this.nodeConfig=this.processConfig.nodeConfig,this.flowPermission=this.processConfig.flowPermission,this.directorMaxLevel=this.processConfig.directorMaxLevel,this.workFlowDef=this.processConfig.workFlowDef,this.tableId=this.processConfig.tableId):this.$axios.get("/flow/data.json",{workFlowDefId:this.$route.params.workFlowDefId}).then((function(t){e.processConfig=t.data,e.nodeConfig=e.processConfig.nodeConfig,e.flowPermission=e.processConfig.flowPermission,e.directorMaxLevel=e.processConfig.directorMaxLevel,e.workFlowDef=e.processConfig.workFlowDef,e.tableId=e.processConfig.tableId})),this.basicSettings=o},methods:{selectItem:function(e){var t=Object.keys(this.actives).reduce((function(t,i){return t[i]=i==e,t}),{});this.actives=t},saveProcess:function(e){var t=w(this.processConfig);t.properties.name=this.basicSettings.name,t.properties.process_id=this.basicSettings.flowKey,window.parent.postMessage({json_xml:t,json:this.processConfig,isDeploy:e,values:this.editForm},"*")},cancelModal:function(){window.parent.postMessage({msg:"close"},"*")},confirm:function(){},handleClose:function(){},toReturn:function(){},reErr:function(e){if(e.childNode){if(1==e.childNode.type)e.childNode.error&&this.tipList.push({name:e.childNode.nodeName,type:"审核人"}),this.reErr(e.childNode);else if(2==e.childNode.type)e.childNode.error&&this.tipList.push({name:e.childNode.nodeName,type:"抄送人"}),this.reErr(e.childNode);else if(3==e.childNode.type)this.reErr(e.childNode.childNode);else if(4==e.childNode.type){this.reErr(e.childNode);for(var t=0;t<e.childNode.conditionNodes.length;t++)e.childNode.conditionNodes[t].error&&this.tipList.push({name:e.childNode.conditionNodes[t].nodeName,type:"条件"}),this.reErr(e.childNode.conditionNodes[t])}}else e.childNode=null},saveSet:function(){var e=w(this.processConfig);e.properties.name=this.basicSettings.name,e.properties.process_id=this.basicSettings.flowKey,window.parent.postMessage({json_xml:e,json:this.processConfig,isDeploy:1,values:this.editForm},"*")},zoomSize:function(e){if(1==e){if(50==this.nowVal)return;this.nowVal-=10}else{if(300==this.nowVal)return;this.nowVal+=10}}}},O=x,N=(i("b584"),i("2877")),_=Object(N["a"])(O,o,n,!1,null,null,null);t["default"]=_.exports},b584:function(e,t,i){"use strict";var o=i("e1f4"),n=i.n(o);n.a},ce7e:function(e,t,i){var o=i("63b6"),n=i("584a"),s=i("294c");e.exports=function(e,t){var i=(n.Object||{})[e]||Object[e],r={};r[e]=t(i),o(o.S+o.F*s((function(){i(1)})),"Object",r)}},e1f4:function(e,t,i){},e265:function(e,t,i){e.exports=i("ed33")},ed33:function(e,t,i){i("014b"),e.exports=i("584a").Object.getOwnPropertySymbols}}]);